# Аудит загрузки роутера (профиль rax3000m_emmc_test_new)

Начало анализа лог-файла `debug.md`.

---
## Анализ строк 1-200

**Ключевые моменты:**

1.  **Инициализация ядра:**
    *   Успешно стартует ядро Linux версии `6.6.95`, собранное `Sun Feb  1 15:34:30 2026`.
    *   Сборка определена как OpenWrt (GCC 13.3.0, r0+33480-082203ae45).
    *   Машина идентифицирована как `CMCC RAX3000M eMMC (MTK UBoot)`, что соответствует профилю.

2.  **Параметры загрузки и хранилище:**
    *   **Командная строка ядра:** `root=/dev/mmcblk0p5 rootwait`. Это критически важный параметр, указывающий, что корневая файловая система находится на 5-м разделе (`p5`) встроенной памяти eMMC (`mmcblk0`).
    *   **eMMC:** Обнаружена карта eMMC `SCA64G` объемом `58.2 GiB`, разбитая на 7 разделов. Это подтверждает, что устройство использует встроенную память, а не NAND/SPI-флеш.

3.  **Сетевая подсистема:**
    *   **Ethernet:** Инициализируется драйвер `mtk_soc_eth` и свитч `mt7530-mdio`. Один из портов показывает активность на скорости `2.5Gbps`.
    *   **Ошибки MTU:** Зафиксированы неопасные ошибки (`nonfatal error -34`, `error -22`) при установке MTU. Это типичное явление для драйверов Mediatek DSA в OpenWrt и не влияет на работу.
    *   **Wi-Fi чип:** Обнаружено PCI-устройство `14c3:7981`, которое является Wi-Fi чипом `MediaTek MT7981`.

4.  **Монтирование и запуск системы:**
    *   Корневая ФС (`squashfs`) успешно смонтирована в режиме "только для чтения" с раздела `179:5` (что соответствует `mmcblk0p5`).
    *   Запущен процесс `/sbin/init`, который начинает запуск пользовательского окружения.

5.  **Сторонние модули ядра:**
    *   Загружается модуль `conninfra`, который является проприетарным (out-of-tree) и "заражает" ядро (`taints kernel`). Это ожидаемое поведение, так как данный модуль необходим для работы специфичного оборудования Mediatek (Wi-Fi, аппаратное ускорение и т.д.). Далее в логе идет детальная инициализация этим модулем различных аппаратных блоков.

**Вывод по первому блоку:**
Загрузка ядра проходит штатно. Система корректно идентифицирует оборудование (процессор, eMMC, сетевые интерфейсы). Параметры загрузки соответствуют конфигурации для устройства с eMMC. Начальная инициализация сетевой подсистемы и загрузка проприетарных драйверов Mediatek проходят успешно.

---
## Анализ строк 201-400

**Ключевые моменты:**

1.  **Завершение инициализации `conninfra`:**
    *   Модуль продолжает низкоуровневую настройку Wi-Fi, считывая eFuse (встроенную память чипа) и записывая конфигурационные значения через SPI.
    *   Однозначно идентифицирован чип: `A-die CHIP ID = 0x7976` и `SKU Type: 3000`.
    *   Завершается процесс включением питания на Wi-Fi блок (`WF=[1]`).

2.  **Обнаружение внешнего диска:**
    *   `usb 2-1: new SuperSpeed USB device number 2 using xhci-mtk`: К порту USB 3.0 подключено устройство.
    *   `scsi 0:0:0:0: Direct-Access JMicron Tech 4101`: Это внешний диск в корпусе на чипе JMicron.
    *   `[sda] 468862128 512-byte logical blocks: (240 GB/224 GiB)`: Обнаружен SSD объемом 240 ГБ.
    *   `xhci-mtk 11200000.usb: ERROR Transfer event for unknown stream`: Зафиксирована ошибка USB-контроллера. Хотя диск и определился, эта ошибка может указывать на потенциальные проблемы со стабильностью USB под нагрузкой. Требует наблюдения.

3.  **Монтирование OverlayFS (ключевой этап):**
    *   `F2FS-fs (mmcblk0p6): Mounted`: Система монтирует 6-й раздел eMMC (`p6`), отформатированный в `F2FS`.
    *   `mount_root: switching to f2fs overlay`: Это подтверждение того, что система успешно переключилась на использование раздела `p6` в качестве `overlay`. Теперь все изменения конфигурации будут сохраняться на этот раздел, обеспечивая персистентность данных.

4.  **Аппаратное ускорение (HNAT):**
    *   Загружен модуль `mediatek_soc_hnat`. Это ядро системы аппаратного NAT, которое позволяет обрабатывать трафик без участия ЦП.
    *   Загружены и запущены модули `WARP` (`warp_module_init`) и `WED` (Wireless Ethernet Dispatch). Они отвечают за аппаратное ускорение Wi-Fi трафика, что критически важно для достижения высоких скоростей.

5.  **Инициализация Wi-Fi драйвера:**
    *   Начинается запуск основного драйвера Wi-Fi (`mt7981_init`).
    *   Сообщение `Use the default iPAiLNA bin image!` говорит об использовании стандартного firmware для усилителей сигнала.

6.  **Активация SWAP:**
    *   `Adding 2097148k swap on /dev/mmcblk0p7`: Система успешно активировала раздел подкачки размером 2 ГБ на 7-м разделе eMMC (`p7`). Это значительно повышает стабильность системы при нехватке оперативной памяти.

**Вывод по второму блоку:**
Система успешно завершила этап `preinit`. Корневая файловая система (overlay) корректно смонтирована на F2FS-раздел eMMC. Обнаружен внешний SSD, хотя и с ошибкой в логе USB. Важнейшие компоненты для производительности — аппаратный NAT и ускорение Wi-Fi — загружены. Началась инициализация Wi-Fi драйвера. Активирован раздел подкачки. Система сконфигурирована правильно.
